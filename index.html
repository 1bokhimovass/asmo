<!DOCTYPE html>
<html lang="uz">
  <head>
    <link rel="manifest" href="manifest.json" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <meta name="apple-mobile-web-app-title" content="ASMO AVTO" />
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>ASMO AVTO - Boshqaruv Paneli</title>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="config.js"></script>

    <style>
      :root {
        --primary-blue: #0d6efd;
        --bg-color: #f0f2f5;
        --card-bg: #ffffff;
        --text-color: #1a1d20;
        --sidebar-bg: #ffffff;
      }

      [data-theme="dark"] {
        --bg-color: #121212;
        --card-bg: #1e1e1e;
        --text-color: #e0e0e0;
        --sidebar-bg: #1e1e1e;
      }

      body {
        background-color: var(--bg-color);
        color: var(--text-color);
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        transition: all 0.3s ease;
      }

      .navbar {
        background: #1a1d20 !important;
        padding: 12px 0;
      }

      /* Sidebar Style */
      .sidebar-link {
        display: flex;
        align-items: center;
        padding: 12px 15px;
        text-decoration: none;
        color: var(--text-color);
        border-radius: 10px;
        margin-bottom: 5px;
        transition: 0.2s;
      }
      .sidebar-link:hover {
        background: rgba(13, 110, 253, 0.1);
        color: var(--primary-blue);
      }
      .offcanvas {
        background-color: var(--sidebar-bg);
        color: var(--text-color);
      }

      /* Cards Style */
      .dept-card {
        transition: all 0.2s ease;
        border-radius: 18px;
        border: none;
        padding: 18px;
        background: var(--card-bg);
        display: flex;
        align-items: center;
        height: 100%;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        color: var(--text-color);
        text-decoration: none;
        cursor: pointer;
      }
      .dept-card:active {
        transform: scale(0.97);
      }

      .border-production {
        border-left: 6px solid #0d6efd;
      }
      .border-archive {
        border-left: 6px solid #0dcaf0;
      }
      .border-warehouse {
        border-left: 6px solid #198754;
      }
      .border-logistics {
        border-left: 6px solid #6f42c1;
      }

      .dept-icon {
        width: 70px;
        height: 70px;
        margin-right: 15px;
        background: white;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 5px;
      }
      .dept-icon img {
        width: 100%;
        object-fit: contain;
      }

      .welcome-header {
        background: var(--card-bg);
        padding: 25px 0;
        border-radius: 0 0 25px 25px;
        margin-bottom: 20px;
      }

      .burger-btn {
        background: none;
        border: none;
        color: white;
        font-size: 1.5rem;
      }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-dark sticky-top shadow-sm">
      <div class="container d-flex align-items-center px-3">
        <button
          class="burger-btn me-3"
          data-bs-toggle="offcanvas"
          data-bs-target="#sidebarMenu"
        >
          ‚ò∞
        </button>
        <span
          class="navbar-brand fw-bold m-0"
          style="font-size: 1rem; letter-spacing: 0.5px"
          >ASMO AVTO</span
        >
      </div>
    </nav>

    <div class="offcanvas offcanvas-start" tabindex="-1" id="sidebarMenu">
      <div class="offcanvas-header border-bottom">
        <h5 class="offcanvas-title fw-bold">Menyu</h5>
        <button
          type="button"
          class="btn-close text-reset"
          data-bs-dismiss="offcanvas"
        ></button>
      </div>
      <div class="offcanvas-body">
        <a href="#" class="sidebar-link" onclick="toggleTheme()">
          <span class="me-3">üåó</span> Kun / Tun rejimi
        </a>
        <a href="settings.html" class="sidebar-link">
          <span class="me-3">‚öôÔ∏è</span> Sozlamalar (Kalkulyator)
        </a>
        <a href="#" class="sidebar-link text-danger mt-5" onclick="chiqish()">
          <span class="me-3">üö™</span> Tizimdan chiqish
        </a>
      </div>
    </div>

    <div class="welcome-header shadow-sm">
      <div class="container">
        <h2 class="fw-bold mb-1">Boshqaruv Paneli</h2>
        <p class="text-muted mb-0 small">Ishlab chiqarish va ombor nazorati</p>
      </div>
    </div>

    <main class="container pb-5">
      <div id="productSection">
        <h6 class="text-uppercase small fw-bold text-muted mb-3">
          üì¶ MAHSULOTLAR
        </h6>
        <div class="row g-3">
          <div
            class="col-12 col-md-4"
            onclick="openSub('Gore-Tex Patch','Gore')"
          >
            <div class="dept-card border-production">
              <div class="dept-icon">
                <img src="./assets/gere_-removebg-preview.png" />
              </div>
              <div>
                <h6 class="fw-bold mb-0">Gore-Tex Patch</h6>
                <small class="text-muted">Lentalash va test</small>
              </div>
            </div>
          </div>
          <div class="col-12 col-md-4" onclick="openSub('LED PCB','LED')">
            <div class="dept-card border-production">
              <div class="dept-icon">
                <img src="./assets/led-removebg-preview.png" />
              </div>
              <div>
                <h6 class="fw-bold mb-0">LED PCB</h6>
                <small class="text-muted">Elektr va yig‚Äòuv</small>
              </div>
            </div>
          </div>
          <div
            class="col-12 col-md-4"
            onclick="openSub('Avto Switch','Switch')"
          >
            <div class="dept-card border-production">
              <div class="dept-icon"><img src="./assets/logo asmo.png" /></div>
              <div>
                <h6 class="fw-bold mb-0">Switch Stop Pedal</h6>
                <small class="text-muted">Mexanik sinov</small>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div id="subSection" class="d-none">
        <div class="d-flex align-items-center mb-4">
          <button
            class="btn btn-light shadow-sm border me-3"
            onclick="goBack()"
          >
            ‚Üê
          </button>
          <h4 class="fw-bold m-0" id="subTitle"></h4>
        </div>
        <div class="row g-3">
          <div class="col-12 col-md-6">
            <a href="ombor.html" class="dept-card border-production"
              ><div class="dept-icon fs-2">üèóÔ∏è</div>
              <div><h6 class="fw-bold mb-0">Xomashyo ombori</h6></div></a
            >
          </div>
          <div class="col-12 col-md-6">
            <a href="baza.html" class="dept-card border-archive"
              ><div class="dept-icon fs-2">üì¶</div>
              <div><h6 class="fw-bold mb-0">Tayyor mahsulot ombori</h6></div></a
            >
          </div>
          <div class="col-12 col-md-6">
            <a href="ishlab-chiqarish.html" class="dept-card border-warehouse"
              ><div class="dept-icon fs-2">üè¨</div>
              <div><h6 class="fw-bold mb-0">Ishlab chiqarish</h6></div></a
            >
          </div>
          <div class="col-12 col-md-6">
            <a href="logistika.html" class="dept-card border-logistics"
              ><div class="dept-icon fs-2">üöö</div>
              <div><h6 class="fw-bold mb-0">Logistika</h6></div></a
            >
          </div>
        </div>
      </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      // AUTH CHECK
      auth.onAuthStateChanged((user) => {
        if (!user) window.location.href = "login.html";
      });

      function chiqish() {
        if (confirm("Tizimdan chiqmoqchimisiz?")) {
          auth.signOut().then(() => (window.location.href = "login.html"));
        }
      }

      // THEME TOGGLE
      function toggleTheme() {
        const currentTheme =
          document.documentElement.getAttribute("data-theme");
        const newTheme = currentTheme === "dark" ? "light" : "dark";
        document.documentElement.setAttribute("data-theme", newTheme);
        localStorage.setItem("theme", newTheme);
      }

      // LOAD SAVED THEME
      const savedTheme = localStorage.getItem("theme");
      if (savedTheme)
        document.documentElement.setAttribute("data-theme", savedTheme);

      // NAVIGATION LOGIC
      function openSub(title, type) {
        document.getElementById("productSection").classList.add("d-none");
        document.getElementById("subSection").classList.remove("d-none");
        document.getElementById("subTitle").innerText = title;
        localStorage.setItem("selectedProduct", type);
        localStorage.setItem("activeSubTitle", title);
        localStorage.setItem("activeSubStatus", "open");
      }

      function goBack() {
        localStorage.removeItem("activeSubTitle");
        localStorage.removeItem("activeSubStatus");
        document.getElementById("subSection").classList.add("d-none");
        document.getElementById("productSection").classList.remove("d-none");
      }

      window.onload = function () {
        const status = localStorage.getItem("activeSubStatus");
        const title = localStorage.getItem("activeSubTitle");
        if (status === "open" && title) {
          document.getElementById("productSection").classList.add("d-none");
          document.getElementById("subSection").classList.remove("d-none");
          document.getElementById("subTitle").innerText = title;
        }
      };
    </script>
  </body>
</html>
